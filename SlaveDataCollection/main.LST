C51 COMPILER V9.52.0.0   MAIN                                                              01/05/2017 20:31:06 PAGE 1   


C51 COMPILER V9.52.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN main.OBJ
COMPILER INVOKED BY: D:\Keil\C51\BIN\C51.EXE main.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          #include <I2C.h>
   2          #include <DH21.h>
   3          
   4          #define PCF8591 0x90    //PCF8591 addr 
   5          
   6          unsigned char light;
   7          
   8          void rs_intr() interrupt 4 {
   9   1              if(TI==1) { //发送中断
  10   2                      TI=0;
  11   2                      if(count!=6) {
  12   3                              SBUF= outdata[count];
  13   3                              count++;
  14   3                      }
  15   2              }
  16   1      }
  17          
  18          void sys_init() {
  19   1              //定时器初始化
  20   1              TMOD = 0x20;
  21   1              TH1 = 0xfd;
  22   1              TL1 = 0xfd;
  23   1              //串口初始化
  24   1              SCON = 0x50;
  25   1              PCON = 0X00;
  26   1              TI = 0;         //发送FLAG
  27   1              RI = 0;         //接收FLAG
  28   1              //总中断及串口中断允许
  29   1              ES = 1; 
  30   1              EA = 1;
  31   1              //启动定时器
  32   1              TR1 = 1;
  33   1      }
  34          
  35          void main() {
  36   1              sys_init();
  37   1              while(1) {
  38   2                      //收集光照数据
  39   2                      ISendByte(PCF8591, 0x42);
  40   2                      light = IRcvByte(PCF8591);
  41   2                      //收集温度、湿度数据
  42   2                      DH21_collData();
  43   2                      //向上位机发送收集到的数据
  44   2                      outdata[0] = 0xff;
  45   2                      outdata[1] = U8RH_data_L;
  46   2                      outdata[2] = U8RH_data_H;
  47   2                      outdata[3] = U8T_data_L;
  48   2                      outdata[4] = U8T_data_H;
  49   2                      outdata[5] = light;
  50   2                      DH21_sendData(outdata);
  51   2                      Delay(20000);
  52   2              }
  53   1      }
  54          

C51 COMPILER V9.52.0.0   MAIN                                                              01/05/2017 20:31:06 PAGE 2   


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    119    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      1    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
